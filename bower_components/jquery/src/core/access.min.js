define(["../core"],function(e){var t=function(n,r,i,o,s,a,u){var l=0,f=n.length,c=null==i;if("object"===e.type(i)){s=!0;for(l in i)t(n,r,l,i[l],!0,a,u)}else if(void 0!==o&&(s=!0,e.isFunction(o)||(u=!0),c&&(u?(r.call(n,o),r=null):(c=r,r=function(t,n,r){return c.call(e(t),r)})),r))for(;f>l;l++)r(n[l],i,u?o:o.call(n[l],l,r(n[l],i)));return s?n:c?r.call(n):f?r(n[0],i):a};return t});